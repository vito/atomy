use("core")
use("define")

macro(~x for(~e) in(~c)):
  `(~c collect [~e]: ~x)

macro(~x for(~e) in(~c) if(~t)):
  `(~c collect [~e] { ~x } select [~e] { ~t })

Array inject-right(i = _undefined) &block :=
  reverse inject(i) [x, y]: block [y, x]

.infix right 5 .

macro(~a . ~b): `([~a] + ~b)
